<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		<script src="js/mui.min.js"></script>
		<link href="css/mui.min.css" rel="stylesheet" />
		<link href="css/wiki.css" rel="stylesheet" />
		<script type="text/javascript" charset="UTF-8">
			mui.init();
		</script>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav" style="height:74px;background-color: rgb(61,171,201);">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left" style="color: #FFFFFF;margin-top: 30px;"></a>
			<h1 class="mui-title" style="color: #FFFFFF;margin-top: 30px;">RSA</h1>
		</header>
		<div class="mui-content" style="margin-top: 14px;">
			<div class="mui-content">
				<h4><br>Example</h4><br>
				<p>Here is an example of RSA encryption and decryption. The parameters used here are artificially small, but one can also use OpenSSL to generate and examine a real keypair.</p>
				<p>Choose two distinct prime numbers, such as<br>
				p =61 and q =53<br>

Compute n = pq giving<br>

n = 61 x 53 = 3233<br>
Compute the totient of the product as φ(n) = (p − 1)(q − 1) giving<br>
φ(n) = (61 − 1)(53 − 1) = 3120<br>


Choose any number 1 < e < 3120 that is coprime to 3120. Choosing a prime number for e leaves us only to check that e is not a divisor of 3120.
<br>Let e = 17 <br>
Compute d, the modular multiplicative inverse of e (mod φ(n)) yielding,<br>
d = 2753<br>
Worked example for the modular multiplicative inverse:<br>
d x e mod φ(n) = 1<br>
2753 x 17 mod 3120 = 1 <br>
The public key is (n = 3233, e = 17). For a padded plaintext message m, the encryption function is<br>
c(m) = m^17 mod 3233<br>
The private key is (d = 2753). For an encrypted ciphertext c, the decryption function is<br>
m(c) = c^2753 mod 3233<br>
For instance, in order to encrypt m = 65, we calculate<br>
c = 65^17 mod 3233 = 2790<br>
To decrypt c = 2790, we calculate<br>
m = 2790^2753 mod 3233 = 65<br>
Both of these calculations can be computed efficiently using the square-and-multiply algorithm for modular exponentiation. In real-life situations the primes selected would be much larger; in our example it would be trivial to factor n, 3233 (obtained from the freely available public key) back to the primes p and q. e, also from the public key, is then inverted to get d, thus acquiring the private key.<br>
</p>
				
				
			</div>
			<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre><span class="s1">'use strict'</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * RSA hash function reference implementation.</span>
<span class="cm"> *</span>
<span class="cm"> * @namespace</span>
<span class="cm"> */</span>
<span class="kd">var</span> <span class="nx">RSA</span> <span class="o">=</span> <span class="p">{};</span>

<span class="cm">/**</span>
<span class="cm"> * Generates an RSA hash</span>
<span class="cm"> * https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Code</span>
<span class="cm"> *</span>
<span class="cm"> * @returns {array} Result of RSA generation</span>
<span class="cm"> */</span>
<span class="nx">RSA</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="cm">/**</span>
<span class="cm">     * Calculate modular multiplicative inverse.</span>
<span class="cm">     * https://en.wikipedia.org/wiki/Modular_multiplicative_inverse</span>
<span class="cm">     * Function based on PHP variant on http://rosettacode.org/wiki/Modular_inverse</span>
<span class="cm">     *</span>
<span class="cm">     * @param   {a} int</span>
<span class="cm">     * @param   {n} int</span>
<span class="cm">     * @returns {int} Result of modular multiplicative inverse.</span>
<span class="cm">     */</span>
    <span class="kd">function</span> <span class="nx">modular_multiplicative_inverse</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">n</span><span class="p">){</span>
    	<span class="kd">var</span> <span class="nx">t</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nx">nt</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nx">r</span>  <span class="o">=</span> <span class="nx">n</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">){</span>
        	<span class="nx">n</span> <span class="o">=</span> <span class="o">-</span><span class="nx">n</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">){</span>
        	<span class="nx">a</span> <span class="o">=</span> <span class="nx">n</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="nx">a</span> <span class="o">%</span> <span class="nx">n</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">nr</span> <span class="o">=</span> <span class="nx">a</span> <span class="o">%</span> <span class="nx">n</span><span class="p">;</span>
    	<span class="k">while</span> <span class="p">(</span><span class="nx">nr</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    		<span class="kd">var</span> <span class="nx">quot</span><span class="o">=</span> <span class="p">(</span><span class="nx">r</span><span class="o">/</span><span class="nx">nr</span><span class="p">)</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
    		<span class="kd">var</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">nt</span><span class="p">;</span>  <span class="nx">nt</span> <span class="o">=</span> <span class="nx">t</span> <span class="o">-</span> <span class="nx">quot</span><span class="o">*</span><span class="nx">nt</span><span class="p">;</span>  <span class="nx">t</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">;</span>
    		    <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">nr</span><span class="p">;</span>  <span class="nx">nr</span> <span class="o">=</span> <span class="nx">r</span> <span class="o">-</span> <span class="nx">quot</span><span class="o">*</span><span class="nx">nr</span><span class="p">;</span>  <span class="nx">r</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">;</span>
    	<span class="p">}</span>
    	<span class="k">if</span> <span class="p">(</span><span class="nx">r</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="p">}</span>
    	<span class="k">if</span> <span class="p">(</span><span class="nx">t</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="nx">t</span> <span class="o">+=</span> <span class="nx">n</span><span class="p">;</span> <span class="p">}</span>
    	<span class="k">return</span> <span class="nx">t</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Generates a random prime</span>
<span class="cm">     *</span>
<span class="cm">     * @param   {min} int, minimal value</span>
<span class="cm">     * @param   {max} int, maximal value</span>
<span class="cm">     * @returns {int} a random generated prime</span>
<span class="cm">     */</span>
    <span class="kd">function</span> <span class="nx">random_prime</span><span class="p">(</span><span class="nx">min</span><span class="p">,</span> <span class="nx">max</span><span class="p">){</span>
        <span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">((</span><span class="nx">max</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="nx">min</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="nx">min</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">bigInt</span><span class="p">(</span><span class="nx">p</span><span class="p">).</span><span class="nx">isPrime</span><span class="p">()</span><span class="o">===</span><span class="kc">true</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">p</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">random_prime</span><span class="p">(</span><span class="nx">min</span><span class="p">,</span> <span class="nx">max</span><span class="p">);</span>   
        <span class="p">}</span> 
    <span class="p">}</span>

    <span class="c1">// generate values</span>
    <span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="nx">random_prime</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="c1">// 8 bit</span>
        <span class="nx">q</span> <span class="o">=</span> <span class="nx">random_prime</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="c1">// 8 bit</span>
        <span class="nx">n</span> <span class="o">=</span> <span class="nx">p</span> <span class="o">*</span> <span class="nx">q</span><span class="p">,</span>
        <span class="nx">t</span> <span class="o">=</span> <span class="p">(</span><span class="nx">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nx">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="c1">// totient as φ(n) = (p − 1)(q − 1)</span>
        <span class="nx">e</span> <span class="o">=</span> <span class="nx">random_prime</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">t</span><span class="p">),</span>
        <span class="nx">d</span> <span class="o">=</span> <span class="nx">modular_multiplicative_inverse</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">t</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">{</span>
    	<span class="nx">n</span><span class="o">:</span> <span class="nx">n</span><span class="p">,</span> <span class="c1">// public key (part I)</span>
        <span class="nx">e</span><span class="o">:</span> <span class="nx">e</span><span class="p">,</span> <span class="c1">// public key (part II)</span>
        <span class="nx">d</span><span class="o">:</span> <span class="nx">d</span>  <span class="c1">// private key</span>
    <span class="p">};</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Encrypt</span>
<span class="cm"> * Uses BigInteger.js</span>
<span class="cm"> *</span>
<span class="cm"> * @param   {m} int, the 'message' to be encoded</span>
<span class="cm"> * @param   {n} int, n value returned from generate_rsa() aka public key (part I)</span>
<span class="cm"> * @param   {e} int, e value returned from generate_rsa() aka public key (part II)</span>
<span class="cm"> * @returns {int} encrypted hash</span>
<span class="cm"> */</span>
<span class="nx">RSA</span><span class="p">.</span><span class="nx">encrypt</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">m</span><span class="p">,</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">e</span><span class="p">){</span>
	<span class="k">return</span> <span class="nx">bigInt</span><span class="p">(</span><span class="nx">m</span><span class="p">).</span><span class="nx">pow</span><span class="p">(</span><span class="nx">e</span><span class="p">).</span><span class="nx">mod</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span>   
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Decrypt</span>
<span class="cm"> * Uses BigInteger.js</span>
<span class="cm"> *</span>
<span class="cm"> * @param   {mEnc} int, the 'message' to be decoded (encoded with RSA_encrypt())</span>
<span class="cm"> * @param   {d} int, d value returned from generate_rsa() aka private key</span>
<span class="cm"> * @param   {n} int, n value returned from generate_rsa() aka public key (part I)</span>
<span class="cm"> * @returns {int} decrypted hash</span>
<span class="cm"> */</span>
<span class="nx">RSA</span><span class="p">.</span><span class="nx">decrypt</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mEnc</span><span class="p">,</span> <span class="nx">d</span><span class="p">,</span> <span class="nx">n</span><span class="p">){</span>
	<span class="k">return</span> <span class="nx">bigInt</span><span class="p">(</span><span class="nx">mEnc</span><span class="p">).</span><span class="nx">pow</span><span class="p">(</span><span class="nx">d</span><span class="p">).</span><span class="nx">mod</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span>   
<span class="p">};</span>
</pre></div>
	</body>
</html>
